sudo: true
language: php
php:
  - 7.2
  - 7.3

matrix:
  fast_finish: true
  allow_failures:
    - php: 7.3

branches:
  only:
    - /master/
    - /^dev/

before_install:
  - export SCRIPT_DIR=$HOME/islandora/.scripts

install:
  - git clone https://github.com/Islandora/documentation.git $HOME/islandora
  - for D in */; do (cd $D; composer install) done

script:
  - $SCRIPT_DIR/line_endings.sh $TRAVIS_BUILD_DIR
  - .scripts/tester

after_success:
  - bash <(curl -s https://codecov.io/bash)

notifications:
  slack:
    secure: "e1agACzaQoZy/17pOhw/utfKBKWSSBCGlYccSyNG1/CmN1GxXDKg+WjbdxkcUV6apJhHahEQ3LeY9vEhnKB7kTHrOC86FVUcl6jKJMlG3E9c7ZwQMQcV2olb7lcElj+iIf1wMSvklcWQBkFetlvllHnBZV1l/kSX28oA/MZl9hTLUxBM2d19B5AkWN/MDHOfZrvWQnLslUhnbES1K7DWdHXnTyoQcoe/IQ/TIbWUIQCZHvIEsSi8N4bdSVTIZP5iWYdcXgocLMnUzZVn/1kKt9/8DgCMvfVdOdqgQD+kQCbVol/SqfgbwxkWCiD4pIC72SAf1SHIuTmuuMQyr+hnk49yfhIgiJVSg5278FXOqwIFxc+ym0rsrIf4cl/hGkQ6PvRRlhkLcqOjCAmrDfFHVGiAc5Qj8B5GJipbvCypzkWO0gN5asAp5TC+OFPLf0RvKw2NLrWXpHueUto57ZJ8L9F949GPQ/TTHBpKclT8ymy4yJf/SW12zleB0cYvmsP+qq9E08o8nMvrJFLXijZTlRw+2gtLStHG9sxmG9U+YkSPAeCvfzE67Jf3WD2IjzVUfigDGbT3wZ+f9YrF6WhAmvd5S6YjFw27yX4FOfN96RXMwSUmZd5131HiPb5nX+MyCdjnLk92umSvJIR4QTTLHFQVP/Wr6euQ0ot9eATYNtg="
    on_success: change
    on_failure: always
