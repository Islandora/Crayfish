sudo: true
language: php
php:
  - 7.2
  - 7.3

matrix:
  fast_finish: true
  allow_failures:
    - php: 7.3

branches:
  only:
    - /master/
    - /^dev/

env:
  global:
    secure: "ZbvpMvKv2mqOGG20AwMYa0SekYOYvJsm9N2NTI7HP+NEVeJ2Ufvub/gX2Q4ldiXAOst9v2otoZGJqt0+pMcbzz4FaD92J9+zbm0xq3vaTJPPQ4Af78vgS8+wveeqzEhOMvECoWEwKCyNJXbEknXeFPQ+Qkmcau7fzAqDEfOpcSeJ8VUFoy29FxUEvqshRFdXv6WSgnuieyBy/bdRVpgsGYm7cewtVj9+PxmeK2N+sNSugKJo0vG/zlfZz//qS6DqCLg6jYkpcR5HsojjZ2ifCzfDoNcvvcRZorTrUwDqqjHMmF+j18yoahRQXSX1tQxLmuM/KNI4grkPesA5j6/eeBKMOGHr2LjSK1UdWgrb/tcA9nZosM11TZc3S9WrsXMBJYmqjRhbpX9Qm28MCHBZh3cakkDcKgCDH7AgxUGl1rGB1s6iAP5FTJGX3h91wNUkyySemY+4e5nfVmTLLMMnrVBph5BNcWXgT3tnpuA0BWiB72AVA2LMx2KZ68JE3xB2Fu9H3Wz4Yz8sxgld7flV6qBF5uAwFk9c31leDoaIQi++LWyVcdKxvv0HAtvNB5sXQMe87cfWJatRncfCBHvwYAVbVmC3X8Zuhttqj1Ao532dwiyCyzsW/eeARM64VZ3JS2NP8eYro3yRUsCCp9+1Hvvv04voCTp1sJbOx6ODdoA="

before_install:
  - export SCRIPT_DIR=$HOME/islandora/.scripts

install:
  - git clone https://github.com/Islandora/documentation.git $HOME/islandora
  - for D in */; do (cd $D; composer install) done

script:
  - $SCRIPT_DIR/line_endings.sh $TRAVIS_BUILD_DIR
  - .scripts/tester

after_success:
  - bash <(curl -s https://codecov.io/bash)

notifications:
  slack:
    rooms:
      - "${SLACK_INTEGRATION}"
    on_success: change
    on_failure: always
